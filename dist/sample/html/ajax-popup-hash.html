<!doctype html>
<html lang="ja">
  <title>title</title>
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1"
  />
  <link rel="stylesheet" href="/sample/font-select.css" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>

  <script>
    jQuery(function ($) {
      var $data = {
        id: $('.id'),
        name: $('.name'),
        titl: $('.titl'),
        prof: $('.prof'),
        desc: $('.desc'),
        prev: $('.prev a'),
        next: $('.next a'),
        phot: $('.phot img'),
        hall: $('.hall'),
        time: $('.time'),
        movi: $('.movi'),
        slid: $('.slid'),
      }

      var $vL = $('.viewLayer')

      // get lang
      var lang = $('html').attr('lang')

      // get json
      var jsonData
      $.ajax({
        type: 'GET',
        url: '../json/ajax-popup-hash-data.json',
        dataType: 'json',
        // cache: false, // キャッシュしない。バージョン(2?)によって効かない場合があるので注意。
        success: function (json) {
          jsonData = json
          window.location.hash ? getHash() : null
        },
        error: function () {
          alert('Transmition error. Please try again.')
        },
      })

      // event click open or nav
      $('.open a, .nav a').on('click', function (e) {
        var id = e.srcElement.dataset.id
        getData(id, jsonData)
        addHash(id)
        return false
      })

      // event click close
      $('.close a, .overlay').on('click', function () {
        $vL.fadeOut(100)
        clearHash()
        return false
      })

      // get data
      function getData(id, jsonData) {
        $data.id.html(id)
        $data.name.html(jsonData[id].name[lang])
        $data.titl.html(jsonData[id].titl[lang])
        $data.prof.html(jsonData[id].prof[lang])
        $data.desc.html(jsonData[id].desc[lang])
        $data.prev.attr('data-id', jsonData[id].prev)
        $data.next.attr('data-id', jsonData[id].next)
        $data.phot.attr('src', jsonData[id].phot)
        $data.hall.html(jsonData[id].hall)
        $data.time.html(jsonData[id].time)
        $data.movi.html(jsonData[id].movi)
        $data.slid.html(jsonData[id].slid)

        jsonData[id].prev === '' ? $data.prev.hide() : $data.prev.show()
        jsonData[id].next === '' ? $data.next.hide() : $data.next.show()

        $vL.fadeIn(100)
      }

      // add hash
      function addHash(id) {
        window.location.hash = '#' + id
      }

      // clear hash
      function clearHash() {
        try {
          var splitResult = window.location.href.split('#')
          history.replaceState(null, null, splitResult[0])
        } catch (e) {
          window.location.hash = ''
        }
      }

      // get hash onload
      function getHash() {
        var id = window.location.hash.replace(/#/, '')
        if (/^A-[1-3]$/.test(id) || /^B-[1-2]$/.test(id)) {
          getData(id, jsonData)
        }
      }
    })
  </script>

  <style>
    html,
    body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      position: relative;
    }
    div {
      box-sizing: border-box;
    }
    .open {
      margin: 0;
      padding: 0;
      float: right;
    }
    .open li {
      list-style: none;
    }
    .open a {
      display: block;
      width: 60px;
      height: 60px;
      border: #999 1px dotted;
    }
    .viewLayer {
      display: none;
      margin: 0;
      width: 100%;
      height: 100%;
      position: absolute;
      top: 0;
      left: 0;
    }
    .viewLayerInner {
      position: relative;
      padding: 30px;
      width: 100%;
      height: 100%;
      box-sizing: border-box;
    }
    .overlay {
      width: 100%;
      height: 100%;
      min-height: 1200px;
      position: absolute;
      top: 0;
      left: 0;
      background: #000;
      opacity: 0.5;
      box-sizing: border-box;
    }
    .dataBox {
      width: auto;
      max-width: 700px;
      min-height: 700px;
      position: relative;
      margin: 0 auto;
      padding: 30px;
      background: #fff;
      word-break: break-word;
    }
    .close {
      position: absolute;
      top: 0;
      right: 20px;
    }
    .phot img {
      width: 100px;
      height: 100px;
    }
    .navBox {
      position: relative;
      height: 120px;
      margin-top: 24px;
      text-align: center;
    }
    .navBox .prev {
      float: left;
      position: absolute;
      top: 20px;
      left: 0;
    }
    .navBox .next {
      float: left;
      position: absolute;
      top: 20px;
      right: 0;
    }
  </style>

  <ul class="open">
    <li><a href="#" data-id="A-1">A-1</a></li>
    <li><a href="#" data-id="A-2">A-2</a></li>
    <li><a href="#" data-id="A-3">A-3</a></li>
    <li><a href="#" data-id="B-1">B-1</a></li>
    <li><a href="#" data-id="B-2">B-2</a></li>
  </ul>

  <div class="viewLayer">
    <div class="viewLayerInner">
      <div class="overlay"></div>
      <div class="dataBox">
        <div class="navBox">
          <p class="phot">
            <img src="" alt loading="lazy" decoding="async" />
          </p>
          <p class="nav prev"><a href="#" data-id="">prev</a></p>
          <p class="nav next"><a href="#" data-id="">next</a></p>
        </div>
        <p class="name"></p>
        <p class="id"></p>
        <p class="titl"></p>
        <p class="prof"></p>
        <p class="hall"></p>
        <p class="time"></p>
        <p class="desc"></p>
        <p class="movi"></p>
        <p class="slid"></p>
        <p class="close"><a href="#">close</a></p>
      </div>
    </div>
  </div>
</html>
